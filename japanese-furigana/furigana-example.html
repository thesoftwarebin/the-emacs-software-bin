<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Japanese (with furigana) in Org-mode</title>
<!-- 2013-11-18 lun 01:15 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012  Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Japanese (with furigana) in Org-mode</h1>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Proposed header</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">

<pre class="src src-org"><span style="color: #b22222;">#+macro: furigana      @@html:&lt;ruby&gt; $1 ...</span>
<span style="color: #b22222;">#  ... (same line)     &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;$2&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt; ...</span>
<span style="color: #b22222;">#  ... (same line)     &lt;/ruby&gt;@@@@latex:\ruby{$1}{$2}@@</span>
<span style="color: #b22222;">#+LATEX_HEADER: \usepackage[CJK, overlap]{ruby}</span>
<span style="color: #b22222;">#+LATEX:</span> <span style="color: #7f7f7f;">\begin{CJK*}[dnp]{JIS}{min}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Proposed footer</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">

<pre class="src src-org"><span style="color: #b22222;">#+LATEX:</span> <span style="color: #7f7f7f;">\clearpage\end{CJK*}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> How to use it</h2>
<div class="outline-text-2" id="text-3">
<p>
Insert the proposed header and footer into your Org file, this will
enable you to write Japanese text in your Org documents. Text will be
exported correctly in HTML and PDF.
</p>

<p>
You can write Japanese text (ex.: 東京) and use the proposed
macro <code>furigana</code> to add furigana signs on top of a kanji. Examples:
</p>

<ul class="org-ul">
<li><code>{{{furigana(水,mi zu)}}}</code> &rArr; <ruby> 水<rp>(</rp><rt>mi zu</rt><rp>)</rp></ruby>
</li>
<li><code>{{{furigana(亀,かめ)}}}</code> &rArr; <ruby> 亀<rp>(</rp><rt>か め</rt><rp>)</rp></ruby>
</li>
<li><code>{{{furigana(犬,いぬ)}}}</code> &rArr; <ruby> 犬<rp>(</rp><rt>い ぬ</rt><rp>)</rp></ruby>
</li>
<li><code>{{{furigana(猫,ねこ)}}}</code> &rArr; <ruby> 猫<rp>(</rp><rt>ね こ</rt><rp>)</rp></ruby>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Problems and limitations</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Japanese text is suppressed in PDF title</h3>
<div class="outline-text-3" id="text-4-1">
<p>
I don't know any solution or workaround for this yet; sorry :(.
</p>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> PDF output fails if there is Japanese text in Org headlines</h3>
<div class="outline-text-3" id="text-4-2">
<p>
This is due to a limitation of the PDF bookmarks, but there is
a couple of suggested workarounds.
</p>
</div>
<div id="outline-container-sec-4-2-1" class="outline-4">
<h4 id="sec-4-2-1"><span class="section-number-4">4.2.1</span> workaround 1 (boring)</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
Generate output to a LaTeX file instead than PDF, then replace
<code>\section{&lt;japtext&gt;}</code> into <code>\section[simpletext]{japtext}</code> in the
.tex file, where <code>simpletext</code> is some plain ASCII text (actually
I think that all ISO-8859-1 characters are supported as well).
After the corrections, generate a PDF from the .tex file using <code>pdftex</code>.
</p>
</div>
</div>
<div id="outline-container-sec-4-2-2" class="outline-4">
<h4 id="sec-4-2-2"><span class="section-number-4">4.2.2</span> workaround 2</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>
Generate output to a LaTeX file instead than PDF, then in the
.tex file replace
</p>
<div class="org-src-container">

<pre class="src src-latex"><span style="color: #a020f0;">\usepackage</span>{<span style="color: #483d8b;">hyperref</span>}
</pre>
</div>

<p>
into 
</p>

<div class="org-src-container">

<pre class="src src-org">\usepackage[bookmarks=false]{hyperref}
</pre>
</div>

<p>
After the correction, generate a PDF from the .tex file using <code>pdftex</code>.
</p>
</div>
</div>
<div id="outline-container-sec-4-2-3" class="outline-4">
<h4 id="sec-4-2-3"><span class="section-number-4">4.2.3</span> workaround 2 disable hyperref</h4>
<div class="outline-text-4" id="text-4-2-3">
<p>
This can be done by removing <code>hyperref</code> package from the Org
option <code>org-latex-default-packages-alist</code>. This will disable
all hyperref features in the generated PDFs, so it's probably
better <b>not</b> to remove it permanently from your Emacs init file.
</p>
</div>
</div>

<div id="outline-container-sec-4-2-4" class="outline-4">
<h4 id="sec-4-2-4"><span class="section-number-4">4.2.4</span> better workarounds could be&#x2026;</h4>
<div class="outline-text-4" id="text-4-2-4">
<ul class="org-ul">
<li>subclass/extend the Latex exporter so that it automatically
behaves the same as workaround 1
</li>
<li>have an Org <code>#OPTIONS:</code> to disable PDF bookmarks only
(
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2013-11-18 lun 01:15</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.2)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
